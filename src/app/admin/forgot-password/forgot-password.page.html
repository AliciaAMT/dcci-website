<ion-content class="ion-padding">
  <div class="forgot-password-container">
    <div class="forgot-password-card">
      <!-- Header -->
      <div class="page-header">
        <ion-button fill="clear" (click)="goBack()" class="back-button">
          <ion-icon name="arrow-back-outline" slot="start"></ion-icon>
          Back to Login
        </ion-button>
        <h1>Reset Password</h1>
        <p class="page-description">Enter your email address and we'll send you a link to reset your password.</p>
      </div>

      <!-- Email Input Form -->
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="forgot-password-form">
        <!-- Email Field -->
        <ion-item class="form-item">
          <ion-icon name="mail-outline" slot="start"></ion-icon>
          <ion-label position="stacked">Email Address</ion-label>
          <ion-input
            type="email"
            formControlName="email"
            placeholder="Enter your email address"
            [class.ion-invalid]="isFieldInvalid('email')">
          </ion-input>
        </ion-item>
        <ion-note *ngIf="isFieldInvalid('email')" color="danger" class="error-note">
          <ion-icon name="alert-circle-outline"></ion-icon>
          {{ getFieldError('email') }}
        </ion-note>

        <!-- Submit Button -->
        <ion-button
          expand="block"
          type="submit"
          [disabled]="forgotPasswordForm.invalid || isLoading"
          class="submit-button">
          <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
          <ion-icon *ngIf="!isLoading" name="mail-outline" slot="start"></ion-icon>
          <span *ngIf="!isLoading">Send Reset Email</span>
          <span *ngIf="isLoading">Sending...</span>
        </ion-button>
      </form>

      <!-- Status Message -->
      <div *ngIf="statusMessage" class="status-message" [class.success]="statusMessage.success" [class.error]="!statusMessage.success">
        <ion-icon [name]="statusMessage.success ? 'checkmark-circle' : 'alert-circle'"></ion-icon>
        {{ statusMessage.message }}
      </div>

      <!-- Success State -->
      <div *ngIf="showSuccessState" class="success-section">
        <div class="success-icon">
          <ion-icon name="checkmark-circle"></ion-icon>
        </div>
        <h2>Email Sent!</h2>
        <p>We've sent a password reset link to <strong>{{ emailAddress }}</strong></p>
        <p class="instructions">Please check your email and click the link to reset your password.</p>
        
        <div class="info-box">
          <ion-icon name="information-circle-outline"></ion-icon>
          <div>
            <strong>Didn't receive the email?</strong>
            <ul>
              <li>Check your spam/junk folder</li>
              <li>Make sure you entered the correct email address</li>
              <li>Wait a few minutes and try again</li>
            </ul>
          </div>
        </div>

        <div class="action-buttons">
          <ion-button expand="block" (click)="resendEmail()" [disabled]="isResending" class="action-button">
            <ion-spinner *ngIf="isResending" name="crescent" slot="start"></ion-spinner>
            <ion-icon *ngIf="!isResending" name="refresh-outline" slot="start"></ion-icon>
            {{ isResending ? 'Sending...' : 'Resend Email' }}
          </ion-button>
          <ion-button expand="block" fill="outline" (click)="goBack()" class="action-button">
            <ion-icon name="arrow-back-outline" slot="start"></ion-icon>
            Back to Login
          </ion-button>
        </div>
      </div>

      <!-- Footer -->
      <div class="page-footer">
        <p>Remember your password? <a (click)="goBack()" class="login-link">Sign in here</a></p>
      </div>
    </div>
  </div>
</ion-content>