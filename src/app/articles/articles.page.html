<ion-content [fullscreen]="true" class="articles-page">
  <div class="articles-container">
    <app-page-header-with-menu></app-page-header-with-menu>
    <!-- Search Section -->
    <div class="search-section">
      <div class="search-box">
        <ion-input
          [(ngModel)]="searchTerm"
          (ionInput)="onSearchChange()"
          [placeholder]="activeTag ? 'Filtered by tag: ' + activeTag : 'Search articles...'"
          [disabled]="!!activeTag"
          class="search-input">
        </ion-input>
        <ion-icon name="search-outline" class="search-icon"></ion-icon>
      </div>
      
      <div class="search-filters">
        <select [(ngModel)]="searchType" (change)="onSearchTypeChange()" class="filter-select" [disabled]="!!activeTag">
          <option value="all">All Fields</option>
          <option value="title">Title</option>
          <option value="content">Content</option>
          <option value="tags">Tags</option>
          <option value="date">Date</option>
        </select>
        <select [(ngModel)]="sortOption" (change)="onSortChange()" class="filter-select sort-select">
          <option value="date-desc">Date: Newest First</option>
          <option value="date-asc">Date: Oldest First</option>
          <option value="title-asc">Title: A-Z</option>
          <option value="title-desc">Title: Z-A</option>
        </select>
        <label class="youtube-filter-label">
          <ion-checkbox 
            [(ngModel)]="showYouTubeArticles" 
            (ionChange)="onYouTubeFilterChange()"
            class="youtube-checkbox">
          </ion-checkbox>
          <span class="youtube-filter-text">Show YouTube videos</span>
        </label>
      </div>
      
      <!-- Active Tag Filter -->
      <div class="active-tag-filter" *ngIf="activeTag">
        <span class="tag-label">Filtered by tag:</span>
        <span class="active-tag">{{ activeTag }}</span>
        <button class="clear-tag-btn" (click)="clearTagFilter()" aria-label="Clear tag filter">
          <ion-icon name="close-circle-outline"></ion-icon>
        </button>
      </div>
    </div>

    <!-- Loading State -->
    <div class="loading-container" *ngIf="isLoading">
      <ion-spinner></ion-spinner>
      <p>Loading articles...</p>
    </div>

    <!-- Articles List -->
    <div class="articles-list" *ngIf="!isLoading">
      <div class="results-count" *ngIf="filteredArticles.length > 0">
        <span *ngIf="activeTag">Showing {{ filteredArticles.length }} article{{ filteredArticles.length !== 1 ? 's' : '' }} with tag "{{ activeTag }}"</span>
        <span *ngIf="!activeTag">Showing {{ filteredArticles.length }} of {{ articles.length }} articles</span>
      </div>

      <div class="empty-state" *ngIf="filteredArticles.length === 0 && !isLoading">
        <ion-icon name="newspaper-outline"></ion-icon>
        <p *ngIf="activeTag">No articles found with tag "{{ activeTag }}"</p>
        <p *ngIf="!activeTag && searchTerm">No articles found matching "{{ searchTerm }}"</p>
        <p *ngIf="!activeTag && !searchTerm && !showYouTubeArticles">No written articles available</p>
        <p *ngIf="!activeTag && !searchTerm && showYouTubeArticles">No articles available</p>
      </div>

      <div class="article-card" *ngFor="let article of filteredArticles" (click)="navigateToArticle(article.slug!)">
        <div class="article-thumbnail" *ngIf="getThumbnailUrl(article)">
          <img [src]="getThumbnailUrl(article)" [alt]="article.title">
        </div>
        <div class="article-info">
          <h3 class="article-title">{{ article.title }}</h3>
          <div class="article-meta">
            <time class="article-date">
              {{ getDateString(article.publishedAt || article.createdAt) }}
            </time>
          </div>
          <p class="article-excerpt" *ngIf="article.excerpt">
            {{ article.excerpt }}
          </p>
        </div>
      </div>
    </div>
    
    <!-- Footer -->
    <app-footer [version]="version"></app-footer>
  </div>
</ion-content>


